<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Call Google's Natural Language API, Cloud Translation API and Cloud Speech API from R • googleLanguageR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">googleLanguageR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="googlelanguager---r-client-for-the-google-translation-api-google-cloud-natural-language-api-and-google-cloud-speech-api" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#googlelanguager---r-client-for-the-google-translation-api-google-cloud-natural-language-api-and-google-cloud-speech-api" class="anchor"></a>googleLanguageR - R client for the Google Translation API, Google Cloud Natural Language API and Google Cloud Speech API</h1></div>

<p>Note all are paid services, you will need to provide your credit card details for your own Google Project to use them.</p>
<div id="google-natural-language-api" class="section level2">
<h2 class="hasAnchor">
<a href="#google-natural-language-api" class="anchor"></a>Google Natural Language API</h2>
<blockquote>
<p>Google Natural Language API reveals the structure and meaning of text by offering powerful machine learning models in an easy to use REST API. You can use it to extract information about people, places, events and much more, mentioned in text documents, news articles or blog posts. You can also use it to understand sentiment about your product on social media or parse intent from customer conversations happening in a call center or a messaging app.</p>
</blockquote>
<p>Read more <a href="https://cloud.google.com/natural-language/">on the Google Natural Language API</a></p>
</div>
<div id="google-cloud-translation-api" class="section level2">
<h2 class="hasAnchor">
<a href="#google-cloud-translation-api" class="anchor"></a>Google Cloud Translation API</h2>
<blockquote>
<p>Google Cloud Translation API provides a simple programmatic interface for translating an arbitrary string into any supported language. Translation API is highly responsive, so websites and applications can integrate with Translation API for fast, dynamic translation of source text from the source language to a target language (e.g. French to English).</p>
</blockquote>
<p>Read more <a href="https://cloud.google.com/translate/">on the Google Cloud Translation Website</a></p>
</div>
<div id="google-cloud-speech-api" class="section level2">
<h2 class="hasAnchor">
<a href="#google-cloud-speech-api" class="anchor"></a>Google Cloud Speech API</h2>
<blockquote>
<p>Google Cloud Speech API enables you to convert audio to text by applying neural network models in an easy to use API. The API recognizes over 80 languages and variants, to support your global user base. You can transcribe the text of users dictating to an application’s microphone or enable command-and-control through voice among many other use cases.</p>
</blockquote>
<p>Read more <a href="https://cloud.google.com/speech/">on the Google Cloud Speech Website</a></p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<ol>
<li>Create a <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">Google API Console Project</a>
</li>
<li>Within your project, add a <a href="https://support.google.com/cloud/answer/6293589">payment method to the project</a>
</li>
<li>Within your project, check the relevant APIs are activated</li>
</ol>
<ul>
<li><a href="https://console.cloud.google.com/apis/api/language.googleapis.com/overview">Google Natural Language API</a></li>
<li><a href="https://console.cloud.google.com/apis/api/translate.googleapis.com/overview">Google Cloud Translation API</a></li>
<li><a href="https://console.cloud.google.com/apis/api/speech.googleapis.com/overview">Google Cloud Speech API</a></li>
</ul>
<ol>
<li>
<a href="https://cloud.google.com/storage/docs/authentication#generating-a-private-key">Generate a service account credential</a> as a JSON file</li>
<li>Return to R, and install this library via <code>devtools::install_github("MarkEdmondson1234/googleLanguageR")</code>
</li>
</ol>
</div>
<div id="useage" class="section level2">
<h2 class="hasAnchor">
<a href="#useage" class="anchor"></a>Useage</h2>
<p>Once set up you can authenticate your R session by using the <code>gl_auth</code> function pointing at your JSON auth file:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(googleLanguageR)
<span class="kw"><a href="reference/gl_auth.html">gl_auth</a></span>(<span class="st">"location_of_json_file.json"</span>)</code></pre></div>
<p>Call the APIs via the functions:</p>
<ul>
<li>
<code><a href="reference/gl_nlp.html">gl_nlp()</a></code> - Natural Langage API</li>
<li>
<code><a href="reference/gl_speech_recognise.html">gl_speech_recognise()</a></code> - Cloud Speech API</li>
<li>
<code><a href="reference/gl_translate_language.html">gl_translate_language()</a></code> - Cloud Translation API</li>
</ul>
</div>
<div id="natural-language-api" class="section level2">
<h2 class="hasAnchor">
<a href="#natural-language-api" class="anchor"></a>Natural Language API</h2>
<p>The Natural Language API returns natural language understanding technolgies. You can call them individually, or the default is to return them all. The available returns are:</p>
<ul>
<li>
<em>Entity analysis</em> - Finds named entities (currently proper names and common nouns) in the text along with entity types, salience, mentions for each entity, and other properties. If possible, will also return metadata about that entity such as a Wikipedia URL. If using the <strong>v1beta2</strong> endpoint this also includes sentiment for each entity.</li>
<li>
<em>Syntax</em> - Analyzes the syntax of the text and provides sentence boundaries and tokenization along with part of speech tags, dependency trees, and other properties.</li>
<li>
<em>Sentiment</em> - The overall sentiment of the text, represented by a magnitude <code>[0, +inf]</code> and score between <code>-1.0</code> (negative sentiment) and <code>1.0</code> (positive sentiment).</li>
</ul>
<div id="demo-for-entity-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#demo-for-entity-analysis" class="anchor"></a>Demo for Entity Analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">text &lt;-<span class="st"> "to administer medicince to animals is frequently a very difficult matter,</span>
<span class="st">         and yet sometimes it's necessary to do so"</span>
nlp_result &lt;-<span class="st"> </span><span class="kw"><a href="reference/gl_nlp.html">gl_nlp</a></span>(text)

<span class="kw">head</span>(nlp_result$tokens$text)
<span class="co">#      content beginOffset</span>
<span class="co"># 1         to           0</span>
<span class="co"># 2 administer           3</span>
<span class="co"># 3   medicine          14</span>
<span class="co"># 4         to          23</span>
<span class="co"># 5    animals          26</span>
<span class="co"># 6         is          34</span>

<span class="kw">head</span>(nlp_result$tokens$partOfSpeech$tag)
<span class="co">#&gt; [1] "PRT"  "VERB" "NOUN" "ADP"  "NOUN" "VERB"</span>


nlp_result$entities
<span class="co">#       name  type  salience             mentions</span>
<span class="co"># 1 medicine OTHER 0.5268406 medicine, 14, COMMON</span>
<span class="co"># 2  animals OTHER 0.2444008  animals, 26, COMMON</span>
<span class="co"># 3   matter OTHER 0.2287586   matter, 65, COMMON</span>

nlp_result$documentSentiment
<span class="co"># $magnitude</span>
<span class="co"># [1] 0.2</span>
<span class="co">#</span>
<span class="co"># $score</span>
<span class="co"># [1] 0.2</span>
</code></pre></div>
</div>
</div>
<div id="google-translation-api" class="section level2">
<h2 class="hasAnchor">
<a href="#google-translation-api" class="anchor"></a>Google Translation API</h2>
<p>You can only detect language via <code>gl_translate_detect</code>, or translate and detect language via <code>gl_translate_language</code></p>
<div id="language-translation" class="section level3">
<h3 class="hasAnchor">
<a href="#language-translation" class="anchor"></a>Language Translation</h3>
<p>Translate text via <code>gl_translate_language</code>. Note this is a lot more refined than the free version on Google’s translation website.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## translate British into Japanese
japan &lt;-<span class="st"> </span><span class="kw"><a href="reference/gl_translate_language.html">gl_translate_language</a></span>(result_brit_freq$transcript, <span class="dt">target =</span> <span class="st">"ja"</span>)

japan$translatedText
<span class="co">#&gt; [1] "動物に薬を投与することはしばしば非常に困難な問題ですが、時にはそれを行う必要があります"</span></code></pre></div>
<p>You can choose the target language via the argument <code>target</code>. The function will automatically detect the language if you do not define an argument <code>source</code>.</p>
<p>You can also supply web HTML and select the <code>format</code> argument to <code>html</code> which will strip out known tags to give you a cleaner translation.</p>
<p>This function which will also detect the langauge. As it costs the same as <code>gl_translate_detect</code>, its usually cheaper to detect and translate in one step.</p>
</div>
<div id="language-detection" class="section level3">
<h3 class="hasAnchor">
<a href="#language-detection" class="anchor"></a>Language Detection</h3>
<p>This function only detects the language:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## which language is this?
<span class="kw"><a href="reference/gl_translate_detect.html">gl_translate_detect</a></span>(<span class="st">"katten sad på måtten"</span>)
<span class="co">#  confidence isReliable language</span>
<span class="co">#1  0.1863063      FALSE       sv</span>

<span class="kw"><a href="reference/gl_translate_detect.html">gl_translate_detect</a></span>(<span class="st">"katten sidder på måtten"</span>)
<span class="co">#  Detecting language: 39 characters - katten sidder på måtten...</span>
<span class="co">#  [[1]]</span>
<span class="co">#  isReliable language confidence</span>
<span class="co">#  1      FALSE       da   0.536223</span></code></pre></div>
<p>The more text it has, the better. And it helps if its not Danish…</p>
<p>It may be better to use <a href="https://github.com/ropensci/cld2"><code>cld2</code></a> to translate offline first, to avoid charges if the translation is unnecessary (e.g. already in English). You could then verify online for more uncertain cases.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cld2::<span class="kw">detect_language</span>(<span class="st">"katten sad på måtten"</span>)
<span class="co"># [1] NA</span>

cld2::<span class="kw">detect_language</span>(<span class="st">"katten sidder på måtten"</span>)
<span class="co"># [1] "DANISH"</span>
<span class="co"># attr(,"code")</span>
<span class="co"># [1] "da"</span>

<span class="kw"><a href="reference/gl_translate_detect.html">gl_translate_detect</a></span>(<span class="st">"katten sidder på måtten"</span>)
<span class="co">#  Detecting language: 39 characters - katten sidder på måtten...</span>
<span class="co">#  [[1]]</span>
<span class="co">#  isReliable language confidence</span>
<span class="co">#  1      FALSE       da   0.536223</span></code></pre></div>
</div>
<div id="translation-api-limits" class="section level3">
<h3 class="hasAnchor">
<a href="#translation-api-limits" class="anchor"></a>Translation API limits</h3>
<p>The API limits in three ways: characters per day, characters per 100 seconds, and API requests per 100 seconds. All can be set in the API manager <code>https://console.developers.google.com/apis/api/translate.googleapis.com/quotas</code></p>
<p>The library will limit the API calls for for the characters and API requests per 100 seconds, which you can set via the options <code>googleLanguageR.rate_limit</code> and <code>googleLanguageR.character_limit</code>. By default these are set at <code>0.5</code> requests per second, and <code>100000</code> characters per 100 seconds. Change them via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">googleLanguageR.rate_limit =</span> <span class="fl">0.15</span>, 
        <span class="dt">googleLanguageR.character_limit =</span> 10000L)</code></pre></div>
</div>
</div>
<div id="google-cloud-speech-api-1" class="section level2">
<h2 class="hasAnchor">
<a href="#google-cloud-speech-api-1" class="anchor"></a>Google Cloud Speech API</h2>
<p>The Cloud Speech API provides audio transcription. Its accessible via the <code>gl_speech_recognise</code> function.</p>
<p>Arguments include:</p>
<ul>
<li>
<code>audio_source</code> - this is a local file in the correct format, or a Google Cloud Storage URI</li>
<li>
<code>encoding</code> - the format of the sound file - <code>LINEAR16</code> is the common <code>.wav</code> format, other formats include <code>FLAC</code> and <code>OGG_OPUS</code>
</li>
<li>
<code>sampleRate</code> - this needs to be set to what your file is recorded at.<br>
</li>
<li>
<code>languageCode</code> - specify the language spoken as a <a href="https://tools.ietf.org/html/bcp47"><code>BCP-47</code> language tag</a>
</li>
<li>
<code>speechContexts</code> - you can supply keywords to help the translation with some context.</li>
</ul>
<div id="demo-for-google-cloud-speech-api" class="section level3">
<h3 class="hasAnchor">
<a href="#demo-for-google-cloud-speech-api" class="anchor"></a>Demo for Google Cloud Speech API</h3>
<p>A test audio file is installed with the package which reads:</p>
<blockquote>
<p>“To administer medicine to animals is frequently a very difficult matter, and yet sometimes it’s necessary to do so”</p>
</blockquote>
<p>The file is sourced from the <a href="http://www-mobile.ecs.soton.ac.uk/newcomms/">University of Southampton’s speech detection</a> group and is fairly difficult for computers to parse, as we see below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get the sample source file
test_audio &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"googleLanguageR"</span>, <span class="st">"woman1_wb.wav"</span>)

result &lt;-<span class="st"> </span><span class="kw"><a href="reference/gl_speech_recognise.html">gl_speech_recognise</a></span>(test_audio)

## its not perfect but...:)
result$transcript
<span class="co">#&gt; [1] "to administer medicine to animals is freaking care very difficult matter </span>
<span class="co">#  and yet sometimes it's necessary to do so"</span>
result$confidence
<span class="co">#&gt; [1] 0.9154025</span>

## get alternative transcriptions
result2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/gl_speech_recognise.html">gl_speech_recognise</a></span>(test_audio, <span class="dt">maxAlternatives =</span> 2L)

result2$transcript
<span class="co">#&gt; [1] "to administer medicine to animals is freaking care very difficult matter </span>
<span class="co">#  and yet sometimes it's necessary to do so"</span>
<span class="co">#&gt; [2] "to administer medicine to animals is freaking give very difficult matter </span>
<span class="co">#  and yet sometimes it's necessary to do so"</span>

## specify british accent
result_brit &lt;-<span class="st"> </span><span class="kw"><a href="reference/gl_speech_recognise.html">gl_speech_recognise</a></span>(test_audio, <span class="dt">languageCode =</span> <span class="st">"en-GB"</span>)
result_brit
<span class="co">#&gt; [1] "to administer medicine to animals if we can give very difficult matter </span>
<span class="co">#  and yet sometimes it's necessary to do so"</span>

## help it out with context for "frequently"
result_brit_freq &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="reference/gl_speech_recognise.html">gl_speech_recognise</a></span>(test_audio, 
                      <span class="dt">languageCode =</span> <span class="st">"en-GB"</span>, 
                      <span class="dt">speechContexts =</span> <span class="kw">list</span>(<span class="dt">phrases =</span> <span class="kw">list</span>(<span class="st">"is frequently a very difficult"</span>)))
result_brit_freq$transcript
<span class="co">#&gt; "to administer medicine to animals is frequently a very difficult matter </span>
<span class="co">#  and yet sometimes it's necessary to do so"</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mark Edmondson <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.google.com/products/machine-learning/">Google Cloud Machine Learning APIs</a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
